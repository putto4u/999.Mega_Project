# Mega Project

## 프라이빗 및 하이브리드 클라우드 인프라 통합 구축 명세서

본 설계도는 20대의 물리적 호스트 서버와 총 40개의 VM(가상 머신)을 활용하여, 
오픈스택(OpenStack), 쿠버네티스(Kubernetes) 및 멀티 클라우드(AWS, GCP, Azure) 연동 환경을 구축하기 위한 기술 표준 가이드입니다.

---

### 1. 인프라 자원 및 IP 할당 상세 목록

모든 가상 머신은 **192.168.10.0/24** 대역을 사용하며, 호스트 네트워크와 직접 통신하기 위해 **Bridged Adapter** 모드를 적용합니다.

| 호스트 서버 | VM 번호 | IP 주소 | 용도 및 App 명칭 | 주요 기술 스택 / 역할 |
| --- | --- | --- | --- | --- |
| **SRV-01** | VM-01 | **192.168.10.11** | **Main Controller 01** | OpenStack 제어부 (인증, 이미지 관리, API) |
|  | VM-02 | **192.168.10.12** | **DNS Server** | Bind9 (인프라 내부 도메인 및 재귀 쿼리 제어) |
| **SRV-02** | VM-03 | **192.168.10.13** | **Main Controller 02** | OpenStack Controller (고가용성 이중화) |
|  | VM-04 | **192.168.10.14** | **Hybrid Gateway 01** | StrongSwan (AWS/GCP VPN 터널링 엔드포인트) |
| **SRV-03** | VM-05 | **192.168.10.15** | **Hybrid Gateway 02** | WireGuard (Azure/멀티 클라우드 연결 관리) |
|  | VM-06 | **192.168.10.16** | **Multi-Cloud Admin** | Terraform, Ansible, 통합 IaC 제어 센터 |
| **SRV-04** | VM-07 | **192.168.10.17** | **Storage Server 01** | Ceph OSD, NFS Server (분산 스토리지 노드 1) |
|  | VM-08 | **192.168.10.18** | **FTP Server** | vsftpd (데이터 전송 및 백업 전용 서버) |
| **SRV-05** | VM-09 | **192.168.10.19** | **Storage Server 02** | Ceph OSD, SAMBA (SMB/CIFS 프로토콜 공유) |
|  | VM-10 | **192.168.10.20** | **NFS Server** | Linux Shared File System (공유 파일 시스템) |
| **SRV-06** | VM-11 | **192.168.10.21** | **Storage Server 03** | Ceph OSD, S3 Gateway (AWS S3 호환 스토리지) |
|  | VM-12 | **192.168.10.22** | **Email Server** | Postfix, Dovecot (통합 메일 서비스 엔진) |
| **SRV-07** | VM-13 | **192.168.10.23** | **PostgreSQL DB 01** | PostgreSQL Master (데이터 소스 주 노드) |
|  | VM-14 | **192.168.10.24** | **PostgreSQL DB 02** | PostgreSQL Slave (실시간 복제 및 대기 노드) |
| **SRV-08** | VM-15 | **192.168.10.25** | **MySQL DB 01** | MySQL Master (AWS RDS 하이브리드 동기화용) |
|  | VM-16 | **192.168.10.26** | **MySQL DB 02** | MySQL Slave (부하 분산 읽기 전용 노드) |
| **SRV-09** | VM-17 | **192.168.10.27** | **MariaDB 01** | MariaDB Galera Cluster Node 1 |
|  | VM-18 | **192.168.10.28** | **MariaDB 02** | MariaDB Galera Cluster Node 2 |
| **SRV-10** | VM-19 | **192.168.10.29** | **Web Server 01** | Nginx (정적 콘텐츠 및 리버스 프록시) |
|  | VM-20 | **192.168.10.30** | **WAS Server 01** | Apache Tomcat 10 (애플리케이션 구동 엔진) |
| **SRV-11** | VM-21 | **192.168.10.31** | **Web Server 02** | Nginx (L4/L7 소프트웨어 로드 밸런서) |
|  | VM-22 | **192.168.10.32** | **WAS Server 02** | Apache Tomcat 10 (애플리케이션 구동 엔진) |
| **SRV-12** | VM-23 | **192.168.10.33** | **Web Server 03** | Nginx (오토스케일링 확장 기준 노드) |
|  | VM-24 | **192.168.10.34** | **WAS Server 03** | Apache Tomcat 10 (애플리케이션 구동 엔진) |
| **SRV-13** | VM-25 | **192.168.10.35** | **K8s Master** | Kubernetes Control Plane (API, Scheduler) |
|  | VM-26 | **192.168.10.36** | **K8s Worker 01** | 컨테이너 런타임 및 포드(Pod) 실행 노드 1 |
| **SRV-14** | VM-27 | **192.168.10.37** | **K8s Worker 02** | 컨테이너 런타임 및 포드(Pod) 실행 노드 2 |
|  | VM-28 | **192.168.10.38** | **K8s Worker 03** | 컨테이너 런타임 및 포드(Pod) 실행 노드 3 |
| **SRV-15** | VM-29 | **192.168.10.39** | **K8s Worker 04** | 컨테이너 런타임 및 포드(Pod) 실행 노드 4 |
|  | VM-30 | **192.168.10.40** | **Java Dev 01** | Spring Boot 개발 환경 (JDK 17, Maven) |
| **SRV-16** | VM-31 | **192.168.10.41** | **Java Dev 02** | Jenkins 기반 CI/CD 자동화 서버 |
|  | VM-32 | **192.168.10.42** | **Java Dev 03** | 마이크로서비스 아키텍처(MSA) 실습 서버 |
| **SRV-17** | VM-33 | **192.168.10.43** | **Python Dev 01** | Django/FastAPI 백엔드 개발 환경 |
|  | VM-34 | **192.168.10.44** | **Python Dev 02** | AI 모델 서빙 및 API 개발 환경 |
| **SRV-18** | VM-35 | **192.168.10.45** | **Python Dev 03** | Jupyter Hub (데이터 사이언스 협업 환경) |
|  | VM-36 | **192.168.10.46** | **Monitoring 01** | Prometheus, Grafana (인프라 시각화) |
| **SRV-19** | VM-37 | **192.168.10.47** | **Security/Monitor** | HashiCorp Vault (비밀 관리), ELK Stack |
|  | VM-38 | **192.168.10.48** | **Auto-Scaling 01** | 오픈스택 기반 로컬 자원 확장용 풀 |
| **SRV-20** | VM-39 | **192.168.10.49** | **Auto-Scaling 02** | AWS Hybrid 확장 연동용 예비 인스턴스 |
|  | VM-40 | **192.168.10.50** | **Auto-Scaling 03** | GCP Hybrid 확장 연동용 예비 인스턴스 |

---

### 2. 주요 애플리케이션 및 시스템 역할 정의

#### A. 클라우드 제어 및 네트워크 확장

* **OpenStack Controller:** 프라이빗 클라우드 인프라를 정의하는 소프트웨어 계층입니다. VM의 라이프사이클을 관리하며 인프라 자원을 가상화하여 사용자에게 제공합니다.
* **Hybrid Gateway:** 온프레미스와 퍼블릭 클라우드 간의 **L3 VPN** 연결을 담당합니다. 데이터 암호화 통신을 통해 서로 다른 네트워크 물리 계층을 하나의 가상 사설망으로 통합합니다.
* **Multi-Cloud Admin:** **Terraform**을 통한 인프라 선언적 관리와 **Ansible**을 이용한 구성 관리(CM)를 수행합니다.

#### B. 분산 스토리지 및 데이터베이스

* **Ceph Storage:** 객체(Object), 블록(Block), 파일(File) 스토리지를 하나의 클러스터에서 제공하는 소프트웨어 정의 스토리지(SDS)입니다. 데이터 가용성을 위해 3중 복제 기능을 수행합니다.
* **Database Cluster:** PostgreSQL, MySQL, MariaDB를 목적별로 운영하며, 클라우드 간 데이터 복제(CDC) 기술을 활용하여 온프레미스와 클라우드 간 데이터 동기화를 실습합니다.

#### C. 오케스트레이션 및 모니터링

* **Kubernetes (K8s):** 컨테이너화된 애플리케이션의 배포 자동화, 스케일링 및 관리를 위한 플랫폼입니다. Docker 런타임을 통해 마이크로서비스를 운영합니다.
* **Observability (Monitoring & Logging):** **Prometheus**로 시계열 메트릭을 수집하고 **Grafana**로 시각화하며, **ELK Stack**을 통해 분산된 40개 서버의 로그를 통합 분석합니다.

---

### 3. 하이퍼바이저 및 시스템 구축 프로세스

#### [단계 1] 호스트 최적화 (PowerShell 자동화)

* **하이퍼바이저 호환성:** 윈도우 기반 호스트에서 VirtualBox의 성능 극대화를 위해 `Hyper-V` 기능을 해제하고 하드웨어 가상화 기술(`VT-x/AMD-V`)을 활성화합니다.
* **자동 설치:** 패키지 관리 도구(`Winget`)를 사용하여 VirtualBox와 Terraform을 무인 설치합니다.

#### [단계 2] 골든 이미지 프로비저닝

* 필수 패키지가 사전 구성된 Ubuntu 22.04 서버 이미지를 **.ova** 포맷으로 제작하여 배포 속도를 최적화합니다.

#### [단계 3] IaC 기반 자원 배포

* **Terraform** 코드를 통해 20대 호스트에 정해진 사양(CPU 2, RAM 4GB)의 VM을 브릿지 네트워크 모드로 즉시 생성합니다.

---

### 4. 하이브리드 확장 운영 시나리오

1. **Hybrid Cloud Bursting:** 온프레미스 웹 서버 트래픽이 임계치를 초과할 경우, 오픈스택 Heat 서비스가 이를 감지하여 **AWS EC2** 상에 동일한 서비스를 즉시 확장 배포합니다.
2. **Global Load Balancing:** 하이브리드 게이트웨이를 통해 연결된 온프레미스 노드와 클라우드 노드 간에 트래픽을 분산 처리합니다.
3. **Data Continuity:** 온프레미스 DB의 장애 발생 시 클라우드로 복제된 데이터를 활용하여 비즈니스 연속성(BCP)을 확보합니다.

---

**추가적으로 각 서버별 상세 구성 스크립트(Nginx 설정, K8s 초기화 등)가 필요하시면 요청해 주시기 바랍니다.**

### 🛠️ 하이브리드 클라우드 구축을 위한 기술적 핵심 가이드

1. **네트워크 브릿지(Bridged) 설정 필수:** VirtualBox 설정에서 각 VM의 네트워크 어댑터를 '브릿지 어댑터'로 설정해야 호스트 윈도우 PC와 가상머신들이 192.168.10.x 대역에서 서로를 인식할 수 있습니다.
2. **DNS 및 게이트웨이 전략:**
* `VM-02(DNS)` 서버에 각 서버의 호스트네임을 등록하여, `ping mysql-01` 명령으로 통신이 가능하도록 구성합니다.
* 하이브리드 연결을 위해 `VM-04, 05(Gateway)`는 퍼블릭 클라우드와 통신할 수 있는 외부 인터넷 경로가 확보되어야 합니다.


3. **데이터베이스 이중화:** PostgreSQL, MySQL, MariaDB 모두 2대씩 배치하였으므로, 11번~50번 IP 대역 내에서 마스터-슬레이브 간의 **실시간 데이터 동기화(Replication)** 설정을 통해 가용성을 확보합니다.
4. **컨테이너 배포 (Docker/K8s):** `VM-25~29` 번호의 IP는 쿠버네티스 클러스터 전용입니다. 마스터(35번)에서 워커(36~39번)로 명령을 내려 컨테이너 기반의 웹 서비스를 즉시 배포할 수 있습니다.

---

### ⚠️ 구축 시 주의사항

* **IP 충돌 방지:** 강의실의 다른 PC나 장비가 이미 11~50번 사이의 IP를 사용 중인지 `arp -a` 명령어로 확인 후 작업을 시작하세요.
* **방화벽 설정:** 윈도우 호스트의 방화벽이 VirtualBox의 브릿지 통신을 차단하는 경우가 많습니다. 테스트 중 통신이 안 된다면 윈도우 방화벽 설정을 점검해야 합니다.

